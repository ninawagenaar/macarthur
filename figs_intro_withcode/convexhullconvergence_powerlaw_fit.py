import numpy as np
import scipy.optimize
import matplotlib as mpl
import matplotlib.pyplot as plt

# data from one run

k2 = [i for i in range(200, 10001, 100)]
n2 = [0.000806558965153692, 0.00041284102297023395, 0.0002944189864336755, 0.00018453060748258032, 0.00012911441175422755, 0.00010289162675092278, 7.970426623449267e-05, 4.8442196307396657e-05, 4.145112148079555e-05, 3.295270253356186e-05, 2.9722389830455498e-05, 2.553275620020834e-05, 2.352899713697898e-05, 2.0687641311800675e-05, 1.7612049545534525e-05, 1.588913937922154e-05, 1.3179362014725804e-05, 1.1638228173516119e-05, 1.030483990249742e-05, 8.915309630763701e-06, 8.240885163490752e-06, 7.556808051534247e-06, 6.823579015047265e-06, 6.288777430030201e-06, 5.987515517280606e-06, 5.5867389415764634e-06, 5.374497842547399e-06, 5.1425592513254514e-06, 4.809456951804236e-06, 4.524925746540731e-06, 4.28659857809599e-06, 3.960219031484691e-06, 3.723950688594435e-06, 3.375833969587738e-06, 3.2224238243339087e-06, 3.057613385260005e-06, 2.8306324844074027e-06, 2.7404986098211737e-06, 2.601801564194872e-06, 2.4322688088052047e-06, 2.3262679166302647e-06, 2.213827300145965e-06, 2.0610326477710217e-06, 1.946001773167616e-06, 1.8419950287285047e-06, 1.74216688975104e-06, 1.7029495342768541e-06, 1.6683006649476084e-06, 1.599084756720437e-06, 1.500292146960902e-06, 1.4466462427975557e-06, 1.396535055375736e-06, 1.3701498096096998e-06, 1.3289198876886843e-06, 1.2916637132098785e-06, 1.2200614538659948e-06, 1.1928278100814538e-06, 1.1677425240108619e-06, 1.1396677603858762e-06, 1.1002085821276708e-06, 1.0698946844023283e-06, 1.0346551619910827e-06, 1.0048309697641145e-06, 9.72224503015262e-07, 9.416271362638895e-07, 9.210724170038986e-07, 8.956986464747629e-07, 8.765290731016506e-07, 8.490522825921332e-07, 8.121634965663205e-07, 7.918699731490619e-07, 7.587997784552769e-07, 7.329096560759751e-07, 7.183227249685231e-07, 6.95947037332445e-07, 6.79218440824414e-07, 6.658348383759005e-07, 6.482099708104982e-07, 6.368839314818686e-07, 6.148011387763219e-07, 5.878615156884592e-07, 5.790881630884925e-07, 5.558711642095204e-07, 5.452384698179102e-07, 5.304289042440402e-07, 5.195486859621568e-07, 5.093758523866398e-07, 4.982675415599047e-07, 4.893755669588273e-07, 4.7510709366704873e-07, 4.6376114359869547e-07, 4.5169265139310966e-07, 4.3939778004986607e-07, 4.314201949018326e-07, 4.196251751631408e-07, 4.1294368868793896e-07, 4.014505370353305e-07, 3.9628873582664426e-07, 3.89562186176029e-07]
n3 = [0.06294987461024981, 0.04325767634951605, 0.035100026672893136, 0.02611312989993797, 0.02058635920543972, 0.017646727118984518, 0.01508645005853082, 0.013226092929146227, 0.011893582992449248, 0.011049817621472502, 0.01017730575343756, 0.009421923873741633, 0.008816513351586286, 0.00804527028773161, 0.007604371099075302, 0.007206786652570019, 0.006806319351649215, 0.0065004329715147025, 0.00621635146256172, 0.0059031683993737705, 0.005572223583066971, 0.00532364217947523, 0.005109311443487696, 0.004882713954010298, 0.004726535353653083, 0.004517916662598265, 0.0043854306372275165, 0.00423240034586414, 0.0040779668889767695, 0.003940962650149538, 0.0038542297926212887, 0.003729562083621518, 0.0036395693864624823, 0.0035351527797765625, 0.003447426455667757, 0.003370245355149959, 0.00327002633610185, 0.003198131242793223, 0.003118961514331109, 0.0030478581329453913, 0.0029594867306931283, 0.0028773611009129674, 0.0028150503481700895, 0.002748447624820627, 0.0026879730290972903, 0.0026117309251031395, 0.0025571857162748346, 0.0025014761103561156, 0.0024431202367323213, 0.0023927498696408867, 0.0023515540588774364, 0.0023152912092470057, 0.0022710972485190384, 0.0022349131478136552, 0.0021924822128897015, 0.0021616742155441404, 0.002127441120487461, 0.002086305586461168, 0.002053348436928615, 0.0020195696629807802, 0.0019944856706262115, 0.0019587892488469594, 0.001927897017113378, 0.0018923445391397786, 0.0018700304795271627, 0.001844015057697268, 0.0018114492124351456, 0.0017894297336036313, 0.001766874591734191, 0.001739185800870735, 0.0017192219762732774, 0.0016941532542360527, 0.0016740904340605267, 0.0016487073874665858, 0.0016313409000691115, 0.0016089689120588613, 0.0015827087392392691, 0.0015614869285132116, 0.0015398812154441277, 0.0015209805965388234, 0.0015045219791202102, 0.0014873860597527377, 0.0014745314038865365, 0.0014573194440296033, 0.0014400056570471609, 0.0014236511069245505, 0.0014089048950631788, 0.0013958486821223914, 0.0013812518075967395, 0.0013717210183814554, 0.0013595414526559324, 0.0013472890155176165, 0.0013367069274015098, 0.0013226632148223283, 0.0013099777584517636, 0.0012977274992500565, 0.001281959225356899, 0.0012706045306982716, 0.0012545915747219638]
n4 = [0.2568228391576878, 0.20179885510516626, 0.17155403704648697, 0.15106013631327697, 0.13370875069100885, 0.12085832656539541, 0.11010422630106431, 0.10104884523254187, 0.093824257096643, 0.08805916459033514, 0.08367174807984101, 0.07902948509722285, 0.07494433818054858, 0.07188051596383815, 0.06901205138676325, 0.06605211369558739, 0.06337126353390532, 0.06111439858192158, 0.058925950777432234, 0.05723762721482706, 0.055564404632490016, 0.05407296178140808, 0.0524253077694079, 0.05106345574036408, 0.049914397774697195, 0.04879141595244385, 0.04764253362296489, 0.04639119364691213, 0.0455788603922469, 0.044479020459299745, 0.04371196570199487, 0.04295254160597506, 0.042163303772364324, 0.04161493770674407, 0.04079103322712607, 0.040030386577747046, 0.03935829725487505, 0.03869766718141421, 0.038054337802485017, 0.03744123356029527, 0.03683368796921038, 0.036224733512267404, 0.03572907806697101, 0.03514968690768128, 0.034671158290144666, 0.03419300997028152, 0.03368076879260895, 0.03326450742357723, 0.03283884818527871, 0.032395171769803555, 0.031992886814040555, 0.03164480212696685, 0.031193775011675084, 0.03079989823521334, 0.0304592309242655, 0.030072134510802817, 0.02969751770489748, 0.02940765221724706, 0.02912201171780293, 0.0287927108145829, 0.028476223603032258, 0.028191389725026106, 0.0278918320828464, 0.027616835233101544, 0.02734210609582166, 0.02711422493478932, 0.02687378548620467, 0.026574783655068823, 0.02630381499644774, 0.02603953853421115, 0.02582183880009148, 0.02559140423679218, 0.02534435108256261, 0.02512033983116846, 0.024912090024543865, 0.02471441192028634, 0.024494232015841333, 0.024272845528658493, 0.024072409763481906, 0.023912485532785133, 0.023723433786274284, 0.023546552777955587, 0.023336656453855076, 0.02313896698951612, 0.02297563704852501, 0.02281735911333549, 0.02262690297874037, 0.022456624241474543, 0.02229385637890302, 0.022090318007287224, 0.021920266953381895, 0.021770721772323975, 0.021608674663114114, 0.021463501957922126, 0.02133126625562265, 0.021187486070940675, 0.021022383710872727, 0.020891487523681418, 0.02074655551491622]
n5 = [0.5128226017676369, 0.44671381114022346, 0.39953338982281905, 0.3578054591749379, 0.3327733824882214, 0.3087343203012637, 0.2910152925148535, 0.27695688624965764, 0.26479562600241147, 0.25308166857285286, 0.24289893265704388, 0.2328410415341211, 0.22580543379718143, 0.218835909258696, 0.21227495511577488, 0.20639812379770928, 0.20145486124828382, 0.19669716201933474, 0.19193054873817406, 0.1875673690757138, 0.1832308694746535, 0.1792860587048185, 0.17589609385575222, 0.17263382391448545, 0.16952859130827103, 0.1667210123878019, 0.16361510298513826, 0.16085904222968817, 0.15870166532972518, 0.15634505634206608, 0.15406576933542593, 0.15195713694214597, 0.1499514087886472, 0.14768748260015174, 0.14575409150935237, 0.1439025230700498, 0.1421655441140529, 0.14045762910200987, 0.13858520736975366, 0.13711395688278483, 0.1356549221670218, 0.13430879838950127, 0.13277720666883464, 0.13139842462510753, 0.12998743225320442, 0.1286106047246769, 0.12735701943091415, 0.12602994137265422, 0.12491886563842336, 0.1237818449379714, 0.122653368005198, 0.12149068310768862, 0.12052131091974916, 0.1194103263612949, 0.11840624363150398, 0.11738434482022975, 0.11644225762923777, 0.11543691818086166, 0.11461595531738489, 0.11368076584137221, 0.11279728685713486, 0.11186046392798477, 0.11099474494976236, 0.11010142288236835, 0.10929363862446051, 0.10848334602463938, 0.1078544035425183, 0.10708118529842037, 0.10641686765788161, 0.105668522195002, 0.10483368528215598, 0.10412165500751625, 0.10342066489212642, 0.10273113439885972, 0.10206184427831577, 0.10143294634454902, 0.10072528759835708, 0.10011887067378034, 0.09943112969763968, 0.0988679173510667, 0.09828665343810916, 0.09775192628889495, 0.0971280987616806, 0.09655017194757243, 0.0960282359314879, 0.09547801813448908, 0.09498919078452861, 0.0944280315524072, 0.09387515128493962, 0.0934074582178046, 0.09292867877092315, 0.09252022739556798, 0.09204102640360712, 0.0915676808772149, 0.09115776221041949, 0.09068990745473249, 0.09022856287812386, 0.08976348744965124, 0.08928148372016964]
n6 = [0.7387211497643116, 0.6645236818220426, 0.6194148678622634, 0.5821515051684054, 0.5495292625471333, 0.5259236423372872, 0.5043621453820024, 0.48565919235487776, 0.47112716925593134, 0.4572880558155089, 0.4447346048959473, 0.43246558604038265, 0.4218760287501101, 0.41317870729868544, 0.40449794649438253, 0.3961538421525791, 0.38937595095269883, 0.38244854827700525, 0.3761590529138059, 0.36942602183228224, 0.363001829906208, 0.358108974938137, 0.35275850831261957, 0.34790850279457386, 0.34420213542660916, 0.3401195217399057, 0.33584099989107263, 0.33169466552490867, 0.32789738685836256, 0.3239810211434355, 0.32067484237770383, 0.31730898551140274, 0.31422109661621767, 0.3109779280075695, 0.30828341929937686, 0.3057068140201965, 0.30262697045095976, 0.2998123116655428, 0.29713148213724294, 0.29470128587287003, 0.29248990278089404, 0.29036314608810765, 0.2879832355714096, 0.2858664241523624, 0.2835199283524291, 0.2815041677580946, 0.2793605121744228, 0.2775178218199422, 0.27536266183607105, 0.2735430281923784, 0.2717906037609312, 0.26976308890240697, 0.2678732782502733, 0.2660126306787127, 0.26435607578619613, 0.2627960727734705, 0.26100703801975234, 0.25945324563843675, 0.25796657178382376, 0.2565024678052804, 0.2549415120899141, 0.2535371474548559, 0.252023150210148, 0.25069694229320694, 0.24938450244116517, 0.24813790453251028, 0.24678841560289644, 0.24529247305030233, 0.24399274528595827, 0.2426675451278324, 0.24144831952952583, 0.24022922463242669, 0.2390929727945902, 0.23785035759300976, 0.23682984134578, 0.23567570744024302, 0.2344383087080112, 0.2332965432669829, 0.23209145385715624, 0.23095064892006334, 0.23005904753388573, 0.22901345553496488, 0.22796674331324263, 0.22698568563941046, 0.22611098431860166, 0.22514978325318658, 0.22429675382396974, 0.22343188650529322, 0.22252802295404628, 0.2217075150423603, 0.2209550050422736, 0.2200480339611377, 0.21926258291196554, 0.21837959606172996, 0.21754633285664127, 0.21679328899194983, 0.2160087098189869, 0.215215512213203, 0.21444869851983628]
k7 = [200, 400, 600, 800, 1000, 1200, 1400, 1600, 1800, 2000, 2200, 2400, 2600, 2800, 3000]
n7 = [0.8728182420081947, 0.7857963001020563, 0.7279753056639002, 0.6897027820224091, 0.6587381694016758, 0.6328638038745718, 0.6121878374011112, 0.5948031131620368, 0.5796869674381703, 0.5645309345333452, 0.5513923313226226, 0.5397469361958456, 0.5296414024957459, 0.5206993276482995, 0.5126596619369737]
k8 = [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000]
n8 = [0.9782499399928546, 0.9435629570623004, 0.9155381265248002, 0.8911802232649815, 0.8724328680629375, 0.8540917408490298, 0.8390630971643258, 0.824652695775826, 0.8130312325939694, 0.8006455529500318]
k9 = [16, 32, 48, 64, 80, 96]
n9 = [0.9999931946053647, 0.9997434513504317, 0.9986805412848089, 0.9968209878853544, 0.9948639937395021, 0.9925636435542543]
k10 = [16, 32, 48, 64, 80, 96]
n10 = [0.9999990910993808, 0.9999180892503802, 0.9997032792253743, 0.9993153050538766, 0.9986854918590412, 0.9980501521325543]
k11 = [16, 32, 48, 64, 80, 96]
n11 = [0.9999999939822584, 0.9999917261936864, 0.9999380228780579, 0.9998391496067047, 0.9996883409713483, 0.9994763512999025]


def power1(x, c):
    return x**c

def power2(x, c, c0):
    return c0 * x**c


[c4_, c04], _ = scipy.optimize.curve_fit(power2, np.array(k2), np.array(n4), p0=(-0.66, 8.87))
c4manual = -0.66
c04manual = 8.87 
c4muller = -0.66

plt.loglog(k2, power2(np.array(k2), c4manual, c04manual), "--", label="c={0}, c0={1}".format(c4manual, c04manual), c="orange")
plt.loglog(k2, n4, '.', label="n=4", markersize=4, c="red")

c5manual = -0.45
c5muller = -0.5

def power5(x, c0):
    return c0 * x**-0.45

[c05], _ = scipy.optimize.curve_fit(power5, np.array(k2), np.array(n5), p0=(4))


plt.loglog(k2, power2(np.array(k2), c5manual, c05), "--", label="c={0}, c0={1}".format(c5manual, round(c05, 4)), c="grey")
plt.loglog(k2, n5, '.', label="n=5", markersize=4, c="black")

c6manual = -0.33
c6muller = -0.4 

def power6(x, c0):
    return c0 * x**-0.33

[c06], _ = scipy.optimize.curve_fit(power6, np.array(k2), np.array(n6), p0=(6))

plt.loglog(k2, power2(np.array(k2), c6manual, c06), "--", label="c={0}, c0={1}".format(c6manual, round(c06, 5)), c="limegreen")
plt.loglog(k2, n6, '.', label="n=6", markersize=4, c="darkgreen")

c7manual = -0.2
c7muller = -0.33

def power7(x, c0):
    return c0 * x**-0.2

[c07], _ = scipy.optimize.curve_fit(power6, np.array(k2), np.array(n6), p0=(-.1))

c07manual = 2.55

plt.loglog(k7, power2(np.array(k7), c7manual, c07manual), "--", label="c={0}, c0={1}".format(c7manual, round(c07manual, 5)), c="plum")
plt.loglog(k7, n7, '.', label="n=7", markersize=4, c="mediumorchid")

plt.ylabel("$ 1 - V_{hull}$ / $V_{ball}$")
plt.xlabel("$k$")
ax = plt.gca()
# ax.legend(loc="upper center", bbox_to_anchor=(0.5, 1.35), fancybox=True, ncol=2)
plt.tight_layout()
plt.savefig("convexhullconvergence_nolegend.png")
plt.show()